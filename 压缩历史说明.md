# 删除中间提交记录、减小仓库体积

目标：把仓库历史压成**一个提交**，让 `.git` 变小。

---

## 方法一：用脚本（推荐）

在**博客仓库根目录**下执行（即能看到 `.git` 和 `index.html` 的那一层）：

```bash
bash squash_history.sh
```

若脚本不在仓库里，可指定仓库路径：

```bash
bash /path/to/squash_history.sh /path/to/blog
```

执行后会：

1. 用当前工作区内容生成一个全新的「单提交」历史  
2. 当前分支指向这个新提交（旧提交不再被引用）  
3. 执行 `git gc --prune=now --aggressive` 清理旧对象，减小 `.git`

**推送到远程（会覆盖远程历史）：**

```bash
git push --force origin master
```

⚠️ 若别人也在用该仓库，务必先沟通再 force push。

---

## 方法二：手动用「孤儿分支」

在仓库根目录执行：

```bash
# 1. 新建一个无历史的孤儿分支
git checkout --orphan new-main

# 2. 添加当前所有文件（内容不变）
git add -A
git commit -m "chore: squash all history into one commit"

# 3. 删掉旧分支，把当前分支改名为 master
git branch -D master
git branch -m master

# 4. 清理，减小 .git
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# 5. 推送到远程（覆盖远程历史）
git push --force origin master
```

---

## 预期效果

- **提交数**：从很多个变为 1 个  
- **.git 大小**：明显下降（具体取决于原历史里的大文件与提交数）  
- **远程**：执行 `git push --force` 后，GitHub 上的历史也会被替换成这一条提交
