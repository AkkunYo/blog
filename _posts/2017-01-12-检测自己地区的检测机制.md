---
title: "检测自己地区的检测机制"
date: 2017-01-12 22:05:00 +0800
excerpt: "一般一个正常的请求是 [method] [url] [version] Host: [host] 但是还有一个能联网的头域是X-Online-Host，我们加进去就变成了 [method] [url] [version]"
categories: ["技术杂谈"]
tags: ["其他"]
cover: /upload/644885.png
permalink: /archives/1750304857452
---
一般一个正常的请求是

[method] [url] [version]

Host: [host]

但是还有一个能联网的头域是X-Online-Host，我们加进去就变成了

[method] [url] [version]

Host: [host]

X-Online-Host: [host]

其中[url]的意思可以分解为[host][uri]，就是

[method] [host][uri] [version]

Host: [host]

X-Online-Host: [host]

所以这个请求中有3个[host]，不同的地区联网检测优先级不同（少部分是这样），我下面这个方法可以测试优先级！

把这三个Host写成不同的域名，当然你要安装免流平台才能完成这一步，因为要修改HTTP请求头，比如改成

[method] m.baidu.com[uri] [version]

Host: www.sina.com

X-Online-Host: wap.uc.cn

这样子保存，启动免流，用浏览器上网，不要开省流量功能或者云加速之类的，随便上个网站，如果跳到m.baidu.com那么首行优先级最大，如果跳到www.sina.com那么Host优先级最大，如果跳到wap.uc.cn那么X-Online-Host优先级最大，最近四川移动是X-Online-Host优先级最大！

现在测优先级第二的，只要把优先级第一的那一行删了就好了，然后用上面的方法测就好了！https同样适用，但是要删除[uri]，还要把Host换成https能访问的Host！

有些地区并没有绝对的优先级，可能是以哪个Host在前面就以哪个为准，所以大家可以把Host的位置顺序换一下再试试！

下面是测计费检测优先级，这个有些麻烦，因为有些地区并不是只检测一个Host来判断是否收费的，我们这里不讨论这种情况！

一般情况下，一个地区的计费检测优先级和联网检测优先级是一样的，所以可以先试试把联网优先级第一的改成免流Host测试，比如X-Online-Host联网优先级最大，首行第二，Host行第三，就像下面这样改

[method] m.baidu.com[uri] [version]

Host: www.sina.com

X-Online-Host: rd.go.10086.cn

然后查流量，查流量前请确保之前没有用过流量导致的延迟，然后开免流，用浏览器上网，不管什么网站都会跳掌厅（原因不解释，上面说过），多上几个网页，关数据，查流量（注意延迟），如果没扣，说明X-Online-Host计费优先级最大，现在可以删了X-Online-Host这一行测计费优先级第二的了，方法与上面的一样！如果扣了流量，就试试把X-Online-Host的值与联网优先级第二的Host值互换一下，如

[method] rd.go.10086.cn[uri] [version]

Host: www.sina.com

X-Online-Host: m.baidu.com

然后测试是否扣流量，换了之后就一直跳百度是正常的，但是如果还不行就跟Host这一行换一下再试！不过我估计不会搞出个什么名堂，要是联网优级和计费优先级不一样，那么菊花模式就复活了！！！这种情况可以试试换一下行的位置顺序，尽量删除首行Host，这个可能会有影响，而且个人认为写模式不怎么用到这个，除了https的!
